<?xml version="1.0" encoding="UTF-8"?>
<project name="Cycle Monitor application build file" default="all" basedir=".">

	<!-- Import the apama macros, this will also set some standard properties -->
	<import file="apama-macros.xml" />

	<!-- Get a reference to the environemnt, and import default properties -->
	<property environment="env" />
	<property file="default.properties" />

	<!-- Import the filelist for correlator injection -->
	<import file="build-filelists.xml" />

	<!-- Initialise, including file tailoring into the build directory -->
	<target name="init">
		<init/>
		<tstamp />
		<mkdir dir="${log.dir}" />
	</target>

	<!-- Top level start and stop tasks -->
	<target name="all" depends="start, adapters" />
	
	<target name="start" depends="init, framework" />
	
	<target name="framework" depends="start-correlator, inject-correlator" />

	<target name="adapters" />

	<target name="stop" depends="stop-correlator" />

	<!-- Correlator start, stop and load tasks -->
	<target name="start-correlator">
		<start-correlator port="${correlator.port}" console="false" java="true" />
	</target>

	<target name="stop-correlator">
		<kill-correlator port="${correlator.port}" />
	</target>

	<target name="inject-correlator" >
		<engine-inject-filelistid filelistid="utils" />
		<engine-inject-filelistid filelistid="configuration" />
		<engine-inject-filelistid filelistid="source" />
		<engine-inject-filelistid filelistid="strategy" />
	</target>

	<!-- Clean tasks -->
	<target name="clean">
		<delete dir="${build.dir}" />
		<delete includeemptydirs="true">
			<fileset dir="${log.dir}" includes="**/*" />
		</delete>
	</target>
</project>

