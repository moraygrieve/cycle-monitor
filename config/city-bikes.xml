<?xml version="1.0" encoding="UTF-8"?>

<adapter-config xmlns:xi="http://www.w3.org/2001/XInclude">

	<transports>
		<transport name="CityBikes" jarName="city-bikes-adapter.jar"
			className="com.jtech.iaf.CityBikesTransport">
			<property name="city-name" value="${city-name}" />
			<property name="data-url" value="${data-url}" />
			<property name="polling-frequency" value="${polling-frequency}" />
		</transport>
	</transports>

	<codecs>
		<codec name="JNullCodec" jarName="JNullCodec.jar"
			className="com.apama.iaf.codec.nullcodec.JNullCodec" />
	</codecs>

	<mapping>
		<event package="com.jtech.source" name="StationUpdate"
			direction="downstream" encoder="JNullCodec"
			copyUnmappedToDictionaryPayload="true">
			<id-rules>
				<downstream>
					<id fields="__station_update" test="exists" />
				</downstream>
			</id-rules>
			<mapping-rules>
				<map apama="city" transport="city" type="string" default="" />
				<map apama="id" transport="id" type="integer" default="0" />
				<map apama="name" transport="name" type="string" default="" />
				<map apama="lat" transport="lat" type="float" default="0" />
				<map apama="lng" transport="lng" type="float" default="0" />
				<map apama="docked" transport="docked" type="integer" default="0" />
				<map apama="empty" transport="empty" type="integer" default="0" />
				<map apama="active" transport="active" type="boolean" default="false" />
			</mapping-rules>
		</event>
	</mapping>

	<apama>
		<sinks>
			<sink host="localhost" port="${correlator.port}" />
		</sinks>
		<sources>
			<source host="localhost" port="${correlator.port}" channels="CITY-BIKES" />
		</sources>
	</apama>

</adapter-config>
